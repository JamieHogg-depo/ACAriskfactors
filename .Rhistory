mutate(obesity = scale(obesity)[,1],
overweight = scale(overweight)[,1],
diff = abs(overweight - obesity))
summsa2all %>%
filter(model %in% c("obesity", "overweight")) %>%
dplyr::select(mu_median, SA2, model, irsd_5c, ra_sa2, PC1) %>%
pivot_wider(names_from = model, values_from = mu_median) %>%
mutate(obesity = scale(obesity)[,1],
overweight = scale(overweight)[,1],
diff = abs(overweight - obesity))
summsa2all %>%
filter(model %in% c("obesity", "overweight")) %>%
dplyr::select(mu_median, SA2, model, irsd_5c, ra_sa2, PC1) %>%
pivot_wider(names_from = model, values_from = mu_median) %>%
mutate(obesity = scale(obesity),
overweight = scale(overweight),
diff = abs(overweight - obesity))
temp <- summsa2all %>%
filter(model %in% c("obesity", "overweight")) %>%
dplyr::select(mu_median, SA2, model, irsd_5c, ra_sa2, PC1) %>%
pivot_wider(names_from = model, values_from = mu_median) %>%
mutate(obesity = scale(obesity)[,1],
overweight = scale(overweight)[,1],
diff = abs(overweight - obesity)) %>%
left_join(.,ocu, by = "SA2")
temp %>%
ggplot(aes(x = diff, y = PC1))+
geom_point()
temp %>%
ggplot(aes(x = diff, y = irsd_5c))+
geom_point()
temp %>%
ggplot(aes(x = diff, y = irsd_5c, col = ra_sa2))+
geom_boxplot()
temp <- summsa2all %>%
filter(model %in% c("obesity", "overweight")) %>%
dplyr::select(mu_median, SA2, model, irsd_5c, ra_sa2, PC1) %>%
pivot_wider(names_from = model, values_from = mu_median) %>%
mutate(obesity = scale(obesity)[,1],
overweight = scale(overweight)[,1],
diff = abs(overweight - obesity)) %>%
left_join(.,ocu, by = "SA2")
summary(temp$diff)
temp <- summsa2all %>%
filter(model %in% c("obesity", "overweight")) %>%
dplyr::select(mu_median, SA2, model, irsd_5c, ra_sa2, PC1) %>%
pivot_wider(names_from = model, values_from = mu_median) %>%
mutate(obesity = scale(obesity)[,1],
overweight = scale(overweight)[,1],
diff = abs(overweight - obesity)) %>%
left_join(.,ocu, by = "SA2") %>%
filter(diff > 0.5)
temp %>%
ggplot(aes(x = diff, y = irsd_5c, col = ra_sa2))+
geom_boxplot()
temp %>% group_by(ra_sa2) %>% tally()
temp %>% group_by(irsd_5c) %>% tally()
temp %>% group_by(ra_sa2, irsd_5c) %>% tally()
summsa2all %>%
left_join(.,state_name_concor, by = "ps_state") %>%
ggplot(aes(x = mu_median, y = state_name)) %>%
geom_violin()+
facet_wrap(.~model)
summsa2all %>%
left_join(.,state_name_concor, by = "ps_state") %>%
ggplot(aes(x = mu_median, y = state_name)) +
geom_violin()+
facet_wrap(.~model)
summsa2all %>%
left_join(.,state_name_concor, by = "ps_state") %>%
ggplot(aes(x = mu_median, y = state_name)) +
geom_boxplot()+
facet_wrap(.~model)
# Remoteness
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2 = fct_relevel(ra_sa2, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = out, fill = ra_sa2), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
addRemotenessColor()
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2 = fct_relevel(ra_sa2, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2_3c = fct_relevel(ra_sa2_3c, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2_3c, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")
# Remoteness
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2 = fct_relevel(ra_sa2, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = out, fill = ra_sa2), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
addRemotenessColor()
# save object
jsave(filename = paste0("barchart_lisa_ra.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2_3c = fct_relevel(ra_sa2_3c, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2_3c, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2_3c = fct_relevel(ra_sa2_3c, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2_3c, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))+
# save object
jsave(filename = paste0("barchart_lisa_ra.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2_3c = fct_relevel(ra_sa2_3c, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2_3c, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = ifelse(ra_sa2_3c == "Outer regional\nto very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c))) %>% relocate(ra)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional\nto very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c))),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote")) %>% relocate(ra)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional\nto very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>% relocate(ra)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>% relocate(ra)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra_sa2_3c, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
# save object
jsave(filename = paste0("barchart_lisa_ra2.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra_sa2 = fct_relevel(ra_sa2, "Major Cities")) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = out, fill = ra_sa2), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
addRemotenessColor()
# save object
jsave(filename = paste0("barchart_lisa_ra.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "left",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "right",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# save object
jsave(filename = paste0("barchart_lisa_ra2.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(x = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "right",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
# save object
jsave(filename = paste0("barchart_lisa_ra2.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(y = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "right",
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(y = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "right")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
# cities on yaxis instead
summsa2all %>%
mutate(lisa = ifelse(or_EP > 0.9, "H",
ifelse(or_EP < 0.1, "L", NA)),
out = factor(ifelse(is.na(LISA) & !is.na(lisa),
lisa, as.character(LISA)),
levels = c("HH", "H", "L", "LL")),
model = getRFFullNames(model),
ra = factor(ifelse(ra_sa2_3c == "Outer regional to very remote", "Outer regional\nto very remote",
as.character(ra_sa2_3c)),
levels = c("Major Cities",
"Inner Regional",
"Outer regional\nto very remote"))) %>%
filter(!is.na(out)) %>%
ggplot()+theme_bw()+
geom_bar(aes(y = ra, fill = out), position = position_dodge2())+
facet_wrap(.~model)+
labs(fill = "",
x = "",
y = "")+
theme(legend.position = "bottom")+
scale_fill_manual(values = c("red", "coral", "skyblue", "royalblue"),
breaks = c("HH", "H", "L", "LL"))
# save object
jsave(filename = paste0("barchart_lisa_ra2.png"),
base_folder = paste0(base_folder, "/figures"),
square = F, ratio = 9:6)
